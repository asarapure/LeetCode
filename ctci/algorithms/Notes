These are basic algorithms from evernote